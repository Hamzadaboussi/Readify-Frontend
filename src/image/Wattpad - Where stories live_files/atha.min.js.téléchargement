var __atha=function(){function u(){return _.get(window,"wattpad.testGroups.ADS_PROMETHEUS_METRICS",!1)}function p(e,t){window.te.push("event","ad","internal",null,e,t)}function f(e,t,a,d,i){var n=wattpad.utils.getDeviceType(),r=wattpad.utils.generateUUID(),s=_.get(window,"wattpad.testGroups.GDPR_USER",!1),w={id:r,created_at:(new Date).toISOString(),username:wattpad.utils.getCurrentUserAttr("username"),external_id:wattpad.utils.getCurrentUserAttr("externalId"),country_code:wattpad.userCountryCode,app_version:wattpad.revision,platform:"mobile"===n?"mobile-web":"desktop-web",gdpr_is_eu:s,storyid:t,page:e,is_brand_safe:window.ads.is_brand_safe,is_mature:window.ads.is_mature,content_rating:window.ads.content_rating,brand_safety_source:window.ads.brand_safety_source,brand_safety_level:window.ads.brand_safety_level,variation:function(){var e=[];if(wattpad.testGroups.PREBID_TIMEOUT&&wattpad.testGroups.USE_PREBID&&app&&app.experiments){var t=app.experiments.get("prebid-timeout");t&&e.push("pt="+t.current)}return wattpad.testGroups.DELAY_ADS&&e.push("image_moderation=true"),wattpad.testGroups.MATURE_FLAG_REFACTOR&&e.push("content_rating=true"),wattpad.testGroups.EXCLUDE_PREBID_PARTNERS&&wattpad.testGroups.USE_PREBID&&e.push("exclude_prebid_partners=true"),wattpad.testGroups.USE_DOUBLE_VERIFY&&e.push("dv_brand_safety=true"),wattpad.testGroups.USE_BSS&&e.push("use_bss=true"),e.join("&")}()};return void 0!==d&&(w.is_brand_safe=!!d.isBrandSafe,w.is_mature=wattpad.utils.isMatureStory(d),w.brand_safety_source=d.brandSafetySource,w.brand_safety_level=d.brandSafetyLevel),void 0!==i&&(w.content_rating=i.contentRating,w.brand_safety_source=i.brandSafetySource,w.brand_safety_level=i.brandSafetyLevel),void 0!==a&&(w.part_id=a),w}var l="start_time";return{sendPageView:function(e,t,a,d,i){if(!u())return"";window.ads=window.ads||{};var n=f(e,t,a,d,i);return window.ads.page=e,window.ads.story_id=t,window.ads.part_id=a,window.ads.page_view_id=n.id,window.ads.is_brand_safe=n.is_brand_safe,window.ads.is_mature=n.is_mature,window.ads.content_rating=n.content_rating,window.ads.brand_safety_level=n.brand_safety_level,window.ads.brand_safety_source=n.brand_safety_source,n.user_is_premium=!!wattpad.utils.getCurrentUserAttr("isPremium"),n.story_tags=Array.isArray(d.tags)?d.tags.join(" "):"",n.is_paid_story=d.isPaywalled,n.device_type=wattpad.utils.getDeviceType(),p("page_view",n),n.id},sendRequest:function(e,t,a){if(!u())return"";window.ads=window.ads||{},window.ads[e]=window.ads[e]||{};var d=window.ads[e].page=window.ads.page,i=window.ads[e].story_id=window.ads.story_id,n=window.ads[e].part_id=window.ads.part_id,r=0;window.ads[e].hasOwnProperty(l)?r=Date.now()-window.ads[e][l]:window.ads[e][l]=Date.now();var s=f(d,i,n);return s.zone_id=a.zoneId.toString(),s.placement=a.htSlotName,s.page_view_id=window.ads.page_view_id,s.adunit_id=e,s.request_offset=r,s.ad_partner=window.ads[e].ad_partner=t,window.ads[e][t+"_request"]=s.id,p("request",s),s.id},sendBid:function(e,t,a,d){if(!u())return"";var i=window.ads[e].page,n=window.ads[e].story_id,r=window.ads[e].part_id,s=window.ads[e].ad_partner,w=window.ads[e][s+"_request"],_=f(i,n,r),o=Date.now()-window.ads[e][l];return _.ad_partner=s,_.page_view_id=window.ads.page_view_id,_.adunit_id=e,_.partner_id=t,_.price=a,_.dimensions=d,_.request_id=w,_.request_offset=o,p("bid",_),_.id},sendAuctionResult:function(e,t,a){if(!u())return"";var d=window.ads[e].page,i=window.ads[e].story_id,n=window.ads[e].part_id,r=window.ads[e].ad_partner,s=Date.now()-window.ads[e][l],w=f(d,i,n);return w.ad_partner=r,w.page_view_id=window.ads.page_view_id,w.request_id=window.ads[e][r+"_request"],w.adunit_id=e,w.num_bids=a?a.length:0,w.price=t?t.bic:0,w.best_bid_id=t?t.id:null,w.request_offset=s,p("auction_result",w),w.id},sendImpression:function(e,t,a,d){if(!u())return"";var i=window.ads[e].page,n=window.ads[e].story_id,r=window.ads[e].part_id,s=window.ads[e].ad_partner,w=window.ads[e][s+"_request"],_=f(i,n,r),o=Date.now()-window.ads[e][l];return _.ad_partner=s,_.page_view_id=window.ads.page_view_id,_.adunit_id=e,_.price=d,_.request_id=w,_.placement=e.split("-")[0],_.zone_id=t,_.flight_id=a,_.request_offset=o,p("impression",_),_.id}}}();"undefined"!=typeof module&&(module.exports=__atha);
//# sourceMappingURL=atha.min.js.map
